import streamlit as st
import pandas as pd
import numpy as np
import sys
import os
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –º–æ–¥—É–ª—é –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
sys.path.insert(0, str(Path(__file__).parent / "streamlit_model"))
from load_model import load_model, load_metadata, load_metrics, load_boxcox_params, predict_risk

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Ä–∏—Å–∫–∞",
    page_icon="üí∞",
    layout="wide",
    initial_sidebar_state="expanded"
)

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –æ–¥–∏–Ω —Ä–∞–∑
@st.cache_resource
def load_all_model_data():
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç—Ä–∏–∫–∏"""
    try:
        model = load_model()
        metadata = load_metadata()
        metrics = load_metrics()
        lambdas = load_boxcox_params()
        return model, metadata, metrics, lambdas
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {str(e)}")
        st.stop()

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å
model, metadata, metrics, lambdas = load_all_model_data()

# –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
st.title("üè¶ –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Ä–∏—Å–∫–∞")
st.markdown("---")

# –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
with st.sidebar:
    st.header("üìä –û –º–æ–¥–µ–ª–∏")
    
    st.markdown("### –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:")
    col1, col2 = st.columns(2)
    with col1:
        st.metric("–¢–æ—á–Ω–æ—Å—Ç—å", f"{metrics['test_accuracy']*100:.1f}%")
        st.metric("ROC-AUC", f"{metrics['test_roc_auc']:.3f}")
    with col2:
        st.metric("F1-Score", f"{metrics['test_f1']:.3f}")
        st.metric("Precision", f"{metrics['test_precision']:.3f}")
    
    st.markdown("### –í–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:")
    st.info(f"**Recall (–ü–æ–ª–Ω–æ—Ç–∞):** {metrics['test_recall']*100:.1f}%\n\n"
            f"–ù–∞—Ö–æ–¥–∏—Ç {metrics['test_recall']*100:.1f}% –≤—Å–µ—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤")
    
    st.markdown("### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    cm = metrics['confusion_matrix']
    st.write(f"‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π: {cm['tn'] + cm['tp']}")
    st.write(f"‚ùå –õ–æ–∂–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤: {cm['fp']}")
    st.write(f"‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤: {cm['fn']}")
    
    st.markdown("---")
    st.markdown("### üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?")
    with st.expander("–ü–æ–¥—Ä–æ–±–Ω–µ–µ"):
        st.markdown("""
        –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ 
        –¥–µ—Ñ–æ–ª—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤–µ:
        - –õ–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞—ë–º—â–∏–∫–∞
        - –§–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
        - –ò—Å—Ç–æ—Ä–∏–∏ –∫—Ä–µ–¥–∏—Ç–æ–≤
        
        **–í–∞–∂–Ω–æ:** –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ç—ã—Å—è—á 
        —Ä–µ–∞–ª—å–Ω—ã—Ö –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫.
        """)

# –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
tab1, tab2, tab3 = st.tabs(["üéØ –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞", "üìö –û –º–µ—Ç—Ä–∏–∫–∞—Ö", "‚ÑπÔ∏è –û —Å–∏—Å—Ç–µ–º–µ"])

with tab1:
    st.header("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—ë–º—â–∏–∫–∞")
    st.markdown("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∏–∂–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Ä–∏—Å–∫–∞")
    
    # –°–æ–∑–¥–∞—ë–º —Ñ–æ—Ä–º—É
    with st.form("credit_risk_form"):
        # –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ UI
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader("üë§ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ")
            
            person_age = st.slider(
                "–í–æ–∑—Ä–∞—Å—Ç –∑–∞—ë–º—â–∏–∫–∞",
                min_value=int(metadata['feature_ranges']['person_age']['min']),
                max_value=int(metadata['feature_ranges']['person_age']['max']),
                value=30,
                help="–í–æ–∑—Ä–∞—Å—Ç –∑–∞—ë–º—â–∏–∫–∞ –≤ –≥–æ–¥–∞—Ö"
            )
            
            person_income = st.number_input(
                "–ì–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥ (–≤ –¥–æ–ª–ª–∞—Ä–∞—Ö)",
                min_value=1000,
                max_value=1000000,
                value=50000,
                step=1000,
                help="–í–≤–µ–¥–∏—Ç–µ –≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥ –∑–∞—ë–º—â–∏–∫–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö –°–®–ê"
            )
            
            person_home_ownership = st.selectbox(
                "–°—Ç–∞—Ç—É—Å –∂–∏–ª—å—è",
                options=metadata['person_home_ownership_categories'],
                help="–¢–∏–ø –∂–∏–ª—å—è –∑–∞—ë–º—â–∏–∫–∞"
            )
            
            person_emp_length = st.slider(
                "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (–ª–µ—Ç)",
                min_value=0.0,
                max_value=float(metadata['feature_ranges']['person_emp_length']['max']),
                value=5.0,
                step=0.5,
                help="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ—Ç –æ–ø—ã—Ç–∞ —Ä–∞–±–æ—Ç—ã –Ω–∞ —Ç–µ–∫—É—â–µ–º –º–µ—Å—Ç–µ"
            )
            
            cb_person_default_on_file = st.radio(
                "–ï—Å—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—è –¥–µ—Ñ–æ–ª—Ç–æ–≤?",
                options=["–ù–µ—Ç", "–î–∞"],
                help="–ë—ã–ª–∏ –ª–∏ —É –∑–∞—ë–º—â–∏–∫–∞ –¥–µ—Ñ–æ–ª—Ç—ã –≤ –ø—Ä–æ—à–ª–æ–º",
                horizontal=True
            )
            
            cb_person_cred_hist_length = st.slider(
                "–î–ª–∏–Ω–∞ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ (–ª–µ—Ç)",
                min_value=int(metadata['feature_ranges']['cb_person_cred_hist_length']['min']),
                max_value=int(metadata['feature_ranges']['cb_person_cred_hist_length']['max']),
                value=5,
                help="–°–∫–æ–ª—å–∫–æ –ª–µ—Ç –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ —É –∑–∞—ë–º—â–∏–∫–∞"
            )
        
        with col2:
            st.subheader("üíµ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–µ–¥–∏—Ç–∞")
            
            loan_amnt = st.number_input(
                "–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ (–≤ –¥–æ–ª–ª–∞—Ä–∞—Ö)",
                min_value=int(metadata['feature_ranges']['loan_amnt']['min']),
                max_value=int(metadata['feature_ranges']['loan_amnt']['max']),
                value=10000,
                step=500,
                help="–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è —Å—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞"
            )
            
            loan_int_rate = st.slider(
                "–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (%)",
                min_value=float(metadata['feature_ranges']['loan_int_rate']['min']),
                max_value=float(metadata['feature_ranges']['loan_int_rate']['max']),
                value=10.0,
                step=0.1,
                format="%.2f",
                help="–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É"
            )
            
            loan_percent_income = st.slider(
                "–î–æ–ª—è –¥–æ—Ö–æ–¥–∞ –Ω–∞ –∫—Ä–µ–¥–∏—Ç",
                min_value=0.0,
                max_value=1.0,
                value=0.2,
                step=0.01,
                format="%.2f",
                help="–ö–∞–∫—É—é –¥–æ–ª—é –¥–æ—Ö–æ–¥–∞ –∑–∞–π–º—ë—Ç –≤—ã–ø–ª–∞—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É"
            )
            
            loan_intent = st.selectbox(
                "–¶–µ–ª—å –∫—Ä–µ–¥–∏—Ç–∞",
                options=metadata['loan_intent_categories'],
                help="–î–ª—è —á–µ–≥–æ –∑–∞—ë–º—â–∏–∫ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—Ä–µ–¥–∏—Ç"
            )
            
            loan_grade = st.selectbox(
                "–û—Ü–µ–Ω–∫–∞ –∫—Ä–µ–¥–∏—Ç–∞",
                options=metadata['grade_order'],
                help="–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∑–∞—ë–º—â–∏–∫–∞ (A - –ª—É—á—à–∞—è, E - —Ö—É–¥—à–∞—è)"
            )
        
        # –ö–Ω–æ–ø–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        submitted = st.form_submit_button("üîç –û—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫", use_container_width=True)
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
    if submitted:
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        cb_default = 1 if cb_person_default_on_file == "–î–∞" else 0
        
        user_data = {
            "person_age": float(person_age),
            "person_income": float(person_income),  # –í –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ!
            "person_home_ownership": person_home_ownership,
            "person_emp_length": float(person_emp_length),
            "loan_intent": loan_intent,
            "loan_grade": loan_grade,
            "loan_amnt": float(loan_amnt),
            "loan_int_rate": float(loan_int_rate),
            "loan_percent_income": float(loan_percent_income),
            "cb_person_default_on_file": cb_default,
            "cb_person_cred_hist_length": int(cb_person_cred_hist_length)
        }
        
        # –î–µ–ª–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        try:
            result = predict_risk(user_data, model, metadata, lambdas)
            
            # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
            st.markdown("---")
            st.header("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏")
            
            # –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
            col1, col2, col3 = st.columns(3)
            
            with col1:
                risk_prob = result['probability_default'] * 100
                if risk_prob < 30:
                    st.metric(
                        "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞",
                        f"{risk_prob:.1f}%",
                        delta="- –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫",
                        delta_color="normal"
                    )
                elif risk_prob < 50:
                    st.metric(
                        "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞",
                        f"{risk_prob:.1f}%",
                        delta="- –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫",
                        delta_color="off"
                    )
                else:
                    st.metric(
                        "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞",
                        f"{risk_prob:.1f}%",
                        delta="- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫",
                        delta_color="inverse"
                    )
            
            with col2:
                safe_prob = result['probability_non_default'] * 100
                st.metric(
                    "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞",
                    f"{safe_prob:.1f}%",
                )
            
            with col3:
                decision = "‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ" if result['prediction'] == 0 else "‚ùå –û—Ç–∫–∞–∑"
                st.metric(
                    "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è",
                    decision
                )
            
            # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
            st.markdown("### üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π")
            prob_df = pd.DataFrame({
                '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å': ['–í–æ–∑–≤—Ä–∞—Ç –∫—Ä–µ–¥–∏—Ç–∞', '–î–µ—Ñ–æ–ª—Ç'],
                '–ó–Ω–∞—á–µ–Ω–∏–µ': [
                    result['probability_non_default'] * 100,
                    result['probability_default'] * 100
                ]
            })
            
            # –ì—Ä–∞—Ñ–∏–∫
            import plotly.express as px
            fig = px.bar(
                prob_df,
                x='–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å',
                y='–ó–Ω–∞—á–µ–Ω–∏–µ',
                color='–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å',
                color_discrete_map={
                    '–í–æ–∑–≤—Ä–∞—Ç –∫—Ä–µ–¥–∏—Ç–∞': '#2ecc71',
                    '–î–µ—Ñ–æ–ª—Ç': '#e74c3c'
                },
                text='–ó–Ω–∞—á–µ–Ω–∏–µ',
                text_auto='.1f'
            )
            fig.update_traces(textposition='outside')
            fig.update_layout(
                title="–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏—Å—Ö–æ–¥–æ–≤",
                yaxis_title="–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (%)",
                height=400,
                showlegend=False
            )
            st.plotly_chart(fig, use_container_width=True)
            
            # –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
            st.markdown("---")
            st.header("üíº –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è")
            
            if result['prediction'] == 0:
                st.success("### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–î–û–ë–†–ò–¢–¨ –ö–†–ï–î–ò–¢")
                st.markdown(f"""
                **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
                - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫—Ä–µ–¥–∏—Ç–∞: **{safe_prob:.1f}%**
                - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞: **{risk_prob:.1f}%**
                
                **–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ –¥–µ—Ñ–æ–ª—Ç–∞. –ó–∞—ë–º—â–∏–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ 
                —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫—Ä–∏—Ç–µ—Ä–∏—è–º –æ–¥–æ–±—Ä–µ–Ω–∏—è.
                
                **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç:**
                - –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç –∫—Ä–µ–¥–∏—Ç–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏
                - –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—é
                """)
            else:
                st.error("### ‚ùå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–¢–ö–ê–ó–ê–¢–¨ –í –ö–†–ï–î–ò–¢–ï")
                st.markdown(f"""
                **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
                - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞: **{risk_prob:.1f}%**
                - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–≤—Ä–∞—Ç–∞: **{safe_prob:.1f}%**
                
                **–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –¥–µ—Ñ–æ–ª—Ç–∞. –ó–∞—ë–º—â–∏–∫ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 
                –∫—Ä–∏—Ç–µ—Ä–∏—è–º –æ–¥–æ–±—Ä–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –º–æ–¥–µ–ª–∏.
                
                **–ü—Ä–∏—á–∏–Ω—ã –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞:**
                - –ú–æ–¥–µ–ª—å –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –¥–µ—Ñ–æ–ª—Ç–∞
                - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
                
                **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç:**
                - –ò–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å –æ—Ç –Ω–µ–≤—ã–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞
                """)
            
            # –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞
            st.markdown("### üîç –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –æ—Ü–µ–Ω–∫–∏")
            
            # –ê–Ω–∞–ª–∏–∑ –≤–≤–µ–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            risk_factors = []
            
            if loan_percent_income > 0.4:
                risk_factors.append({
                    "factor": "–í—ã—Å–æ–∫–∞—è –¥–æ–ª—è –¥–æ—Ö–æ–¥–∞ –Ω–∞ –∫—Ä–µ–¥–∏—Ç",
                    "value": f"{loan_percent_income*100:.1f}%",
                    "impact": "‚ö†Ô∏è –ü–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if cb_default == 1:
                risk_factors.append({
                    "factor": "–ò—Å—Ç–æ—Ä–∏—è –¥–µ—Ñ–æ–ª—Ç–æ–≤",
                    "value": "–ï—Å—Ç—å",
                    "impact": "‚ùå –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if loan_int_rate > 15:
                risk_factors.append({
                    "factor": "–í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞",
                    "value": f"{loan_int_rate:.2f}%",
                    "impact": "‚ö†Ô∏è –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫"
                })
            
            if loan_grade in ['D', 'E', 'Other']:
                risk_factors.append({
                    "factor": "–ù–∏–∑–∫–∞—è –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞",
                    "value": loan_grade,
                    "impact": "‚ö†Ô∏è –ü–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if person_emp_length < 2:
                risk_factors.append({
                    "factor": "–ú–∞–ª–µ–Ω—å–∫–∏–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã",
                    "value": f"{person_emp_length:.1f} –ª–µ—Ç",
                    "impact": "‚ö†Ô∏è –ú–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å"
                })
            
            positive_factors = []
            
            if cb_default == 0:
                positive_factors.append({
                    "factor": "–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –¥–µ—Ñ–æ–ª—Ç–æ–≤",
                    "value": "–•–æ—Ä–æ—à–æ",
                    "impact": "‚úÖ –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if loan_percent_income < 0.25:
                positive_factors.append({
                    "factor": "–ù–∏–∑–∫–∞—è –¥–æ–ª—è –¥–æ—Ö–æ–¥–∞ –Ω–∞ –∫—Ä–µ–¥–∏—Ç",
                    "value": f"{loan_percent_income*100:.1f}%",
                    "impact": "‚úÖ –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if loan_grade in ['A', 'B']:
                positive_factors.append({
                    "factor": "–í—ã—Å–æ–∫–∞—è –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞",
                    "value": loan_grade,
                    "impact": "‚úÖ –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if person_emp_length > 5:
                positive_factors.append({
                    "factor": "–°—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã",
                    "value": f"{person_emp_length:.1f} –ª–µ—Ç",
                    "impact": "‚úÖ –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫"
                })
            
            if risk_factors or positive_factors:
                col1, col2 = st.columns(2)
                
                with col1:
                    if risk_factors:
                        st.markdown("#### ‚ö†Ô∏è –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞")
                        for factor in risk_factors:
                            st.warning(f"**{factor['factor']}**: {factor['value']} - {factor['impact']}")
                    else:
                        st.info("–ù–µ—Ç —è–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞")
                
                with col2:
                    if positive_factors:
                        st.markdown("#### ‚úÖ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã")
                        for factor in positive_factors:
                            st.success(f"**{factor['factor']}**: {factor['value']} - {factor['impact']}")
                    else:
                        st.info("–ù–µ—Ç —è–≤–Ω—ã—Ö –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤")
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            with st.expander("üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è"):
                st.json({
                    "prediction": result['prediction'],
                    "prediction_class": result['prediction_class'],
                    "probability_default": round(result['probability_default'], 4),
                    "probability_non_default": round(result['probability_non_default'], 4),
                    "risk_level": result['risk_level']
                })
        
        except Exception as e:
            st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏: {str(e)}")
            st.info("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")

with tab2:
    st.header("üìö –ü–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –º–æ–¥–µ–ª–∏")
    
    st.markdown("""
    –≠—Ç–∞ –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞. 
    –ù–∏–∂–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.
    """)
    
    st.markdown("---")
    
    # –ú–µ—Ç—Ä–∏–∫–∏ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫
    metric_explanations = [
        {
            "name": "Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å)",
            "value": f"{metrics['test_accuracy']*100:.1f}%",
            "description": "–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ —Å–∫–æ–ª—å–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –∏–∑ 100 –º–æ–¥–µ–ª—å —Å–¥–µ–ª–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.",
            "business_value": "–ò–∑ 100 –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ü–µ–Ω–∏–ª–∞ 94. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.",
            "icon": "üéØ"
        },
        {
            "name": "Precision (–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π)",
            "value": f"{metrics['test_precision']*100:.1f}%",
            "description": "–ö–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç '–æ—Ç–∫–∞–∑–∞—Ç—å', –Ω–∞—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–æ –æ–Ω–∞ –ø—Ä–∞–≤–∞.",
            "business_value": f"–ò–∑ –≤—Å–µ—Ö –æ—Ç–∫–∞–∑–æ–≤ {metrics['test_precision']*100:.1f}% –±—ã–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å —Ä–µ–¥–∫–æ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç —Ö–æ—Ä–æ—à–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º.",
            "icon": "‚úÖ"
        },
        {
            "name": "Recall (–ü–æ–ª–Ω–æ—Ç–∞)",
            "value": f"{metrics['test_recall']*100:.1f}%",
            "description": "–ò–∑ –≤—Å–µ—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤, —Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç.",
            "business_value": f"–ú–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç {metrics['test_recall']*100:.1f}% –≤—Å–µ—Ö –¥–µ—Ñ–æ–ª—Ç–æ–≤. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –±–∞–Ω–∫–∞.",
            "icon": "üîç"
        },
        {
            "name": "ROC-AUC",
            "value": f"{metrics['test_roc_auc']:.3f}",
            "description": "–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∑–∞—ë–º—â–∏–∫–æ–≤.",
            "business_value": "–ú–æ–¥–µ–ª—å –æ—Ç–ª–∏—á–Ω–æ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ—Ç –∑–∞—ë–º—â–∏–∫–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∏—Å–∫–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –±–æ–ª–µ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.",
            "icon": "üìä"
        },
        {
            "name": "F1-Score",
            "value": f"{metrics['test_f1']:.3f}",
            "description": "–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π –ø–æ–∏—Å–∫–∞ –¥–µ—Ñ–æ–ª—Ç–æ–≤.",
            "business_value": "–•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–µ–º, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç—ã –∏ –Ω–µ –æ—Ç–∫–∞–∑–∞—Ç—å —Ö–æ—Ä–æ—à–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º.",
            "icon": "‚öñÔ∏è"
        }
    ]
    
    for metric in metric_explanations:
        with st.container():
            col1, col2 = st.columns([1, 4])
            with col1:
                st.markdown(f"### {metric['icon']}")
                st.metric("", metric['value'])
            with col2:
                st.markdown(f"#### {metric['name']}")
                st.markdown(metric['description'])
                st.info(f"**–î–ª—è –±–∏–∑–Ω–µ—Å–∞:** {metric['business_value']}")
            st.markdown("---")
    
    # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
    st.markdown("### üìã –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ (Confusion Matrix)")
    
    cm = metrics['confusion_matrix']
    
    st.markdown("""
    –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ 
    –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –∏—Å—Ö–æ–¥ –∫—Ä–µ–¥–∏—Ç–∞:
    """)
    
    col1, col2, col3, col4 = st.columns(4)
    
    with col1:
        st.success(f"**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è**\n\n{cm['tn']}")
        st.caption("–•–æ—Ä–æ—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º –æ–¥–æ–±—Ä–∏–ª–∏")
    
    with col2:
        st.warning(f"**–õ–æ–∂–Ω—ã–µ –æ—Ç–∫–∞–∑—ã**\n\n{cm['fp']}")
        st.caption("–•–æ—Ä–æ—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–∫–∞–∑–∞–ª–∏ (–ø–æ—Ç–µ—Ä—è –ø—Ä–∏–±—ã–ª–∏)")
    
    with col3:
        st.error(f"**–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç—ã**\n\n{cm['fn']}")
        st.caption("–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º –æ–¥–æ–±—Ä–∏–ª–∏ (–ö–†–ò–¢–ò–ß–ù–û!)")
    
    with col4:
        st.success(f"**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç—ã**\n\n{cm['tp']}")
        st.caption("–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–∫–∞–∑–∞–ª–∏")
    
    st.markdown("---")
    st.markdown("### üí° –í—ã–≤–æ–¥—ã")
    st.info(f"""
    **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –º–æ–¥–µ–ª–∏:**
    - –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ({metrics['test_accuracy']*100:.1f}%)
    - –†–µ–¥–∫–æ –æ—à–∏–±–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ ({metrics['test_precision']*100:.1f}% —Ç–æ—á–Ω–æ—Å—Ç–∏)
    - –•–æ—Ä–æ—à–æ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ—Ç –∑–∞—ë–º—â–∏–∫–æ–≤ –ø–æ —Ä–∏—Å–∫—É (ROC-AUC = {metrics['test_roc_auc']:.3f})
    
    **–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
    - –ú–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç {metrics['test_recall']*100:.1f}% –¥–µ—Ñ–æ–ª—Ç–æ–≤, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–Ω–æ 
    {100-metrics['test_recall']*100:.1f}% –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞—ë–º—â–∏–∫–æ–≤
    - –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ª—É—á—à–µ–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ—Ä–æ–≥–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º 
    –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    """)

with tab3:
    st.header("‚ÑπÔ∏è –û —Å–∏—Å—Ç–µ–º–µ –æ—Ü–µ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Ä–∏—Å–∫–∞")
    
    st.markdown("""
    ## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–∞ —Å–∏—Å—Ç–µ–º–∞?
    
    –≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ 
    –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–≥–æ, —á—Ç–æ –∑–∞—ë–º—â–∏–∫ –≤–µ—Ä–Ω—ë—Ç –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ –Ω–µ—Ç (–¥–µ—Ñ–æ–ª—Ç).
    
    –ú–æ–¥–µ–ª—å –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Ç—ã—Å—è—á –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –∏ –Ω–∞—É—á–∏–ª–∞—Å—å 
    –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –∑–∞—ë–º—â–∏–∫–∞ –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –¥–µ—Ñ–æ–ª—Ç–∞.
    """)
    
    st.markdown("---")
    
    st.markdown("### ü§ñ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å?")
    
    st.markdown("""
    1. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:** –í—ã –≤–≤–æ–¥–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞—ë–º—â–∏–∫–µ –∏ –∫—Ä–µ–¥–∏—Ç–µ
    2. **–û–±—Ä–∞–±–æ—Ç–∫–∞:** –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç, –ø–æ–Ω—è—Ç–Ω—ã–π –º–æ–¥–µ–ª–∏
    3. **–ê–Ω–∞–ª–∏–∑:** –ú–æ–¥–µ–ª—å —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ç—ã—Å—è—á–∞–º–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤
    4. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:** –ú–æ–¥–µ–ª—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞ –∏ –¥–µ–ª–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
    """)
    
    st.markdown("---")
    
    st.markdown("### üìä –ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã —É—á–∏—Ç—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å?")
    
    factors_col1, factors_col2 = st.columns(2)
    
    with factors_col1:
        st.markdown("""
        **–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
        - –í–æ–∑—Ä–∞—Å—Ç –∑–∞—ë–º—â–∏–∫–∞
        - –ì–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥
        - –°—Ç–∞—Ç—É—Å –∂–∏–ª—å—è
        - –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã
        
        **–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è:**
        - –î–ª–∏–Ω–∞ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
        - –ù–∞–ª–∏—á–∏–µ –¥–µ—Ñ–æ–ª—Ç–æ–≤ –≤ –ø—Ä–æ—à–ª–æ–º
        """)
    
    with factors_col2:
        st.markdown("""
        **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–µ–¥–∏—Ç–∞:**
        - –°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞
        - –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞
        - –î–æ–ª—è –¥–æ—Ö–æ–¥–∞ –Ω–∞ –∫—Ä–µ–¥–∏—Ç
        - –¶–µ–ª—å –∫—Ä–µ–¥–∏—Ç–∞
        - –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
        """)
    
    st.markdown("---")
    
    st.markdown("### ‚öñÔ∏è –ö–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?")
    
    st.markdown("""
    **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞ –º–µ–Ω–µ–µ 30%** - ‚úÖ –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
    - –ö—Ä–µ–¥–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –æ–¥–æ–±—Ä–µ–Ω–∏—é
    - –ó–∞—ë–º—â–∏–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
    
    **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞ 30-50%** - ‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫
    - –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    - –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
    
    **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–∞ –±–æ–ª–µ–µ 50%** - ‚ùå –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
    - –ö—Ä–µ–¥–∏—Ç –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –æ–¥–æ–±—Ä–µ–Ω–∏—é
    - –í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—Ç–µ—Ä—å
    """)
    
    st.markdown("---")
    
    st.markdown("### üõ°Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è")
    
    st.warning("""
    ‚ö†Ô∏è **–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π, 
    –∞ –Ω–µ –∑–∞–º–µ–Ω–æ–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.**
    
    - –í—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã
    - –†–µ—à–µ–Ω–∏–µ –æ –≤—ã–¥–∞—á–µ –∫—Ä–µ–¥–∏—Ç–∞ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è —Å —É—á—ë—Ç–æ–º –ø–æ–ª–∏—Ç–∏–∫–∏ –±–∞–Ω–∫–∞
    - –ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ –∫–æ–º–ø–ª–µ–∫—Å–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
    """)
    
    st.markdown("---")
    
    st.markdown("### üìà –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏")
    
    tech_info = {
        "–¢–∏–ø –º–æ–¥–µ–ª–∏": metadata['model_type'],
        "–û–±—É—á–µ–Ω–∏–µ": "Gradient Boosting",
        "–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)": f"{metrics['test_accuracy']*100:.2f}%",
        "ROC-AUC": f"{metrics['test_roc_auc']:.3f}",
        "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è": "2024"
    }
    
    st.json(tech_info)
    
    st.markdown("---")
    
    st.markdown("### üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞")
    
    st.info("""
    –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å –≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ 
    —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.
    """)

# Footer
st.markdown("---")
st.markdown(
    """
    <div style='text-align: center; color: gray;'>
        –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Ä–∏—Å–∫–∞ | Powered by Machine Learning
    </div>
    """,
    unsafe_allow_html=True
)

